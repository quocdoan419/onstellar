Change-log:

Improved speed 50%
Fixed bugs